"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3485],{3485:(j,d,i)=>{i.r(d),i.d(d,{LoginPageModule:()=>y});var m=i(177),u=i(4341),v=i(1626),s=i(4742),f=i(4856),c=i(8986),h=i(467),t=i(3953),P=i(4796),L=i(3656),M=i(369),p=i(4621),C=i(9649);const F=[{path:"",component:(()=>{var e;class g{constructor(o,n,r,a,b){this.authService=o,this.navCtrl=n,this.storage=r,this.menuS=a,this.geolocation=b,this.username="",this.password="",this.userid="",this.userLocation={lat:0,lng:0},this.storage.create()}ngOnInit(){this.menuS.habilitarMenu(!1)}getPos(){var o=this;return(0,h.A)(function*(){try{const n=yield o.geolocation.getCurrentPosition();o.storage.set("userLat",n.coords.latitude),o.storage.set("userLng",n.coords.longitude),o.guardarPos(n.coords.latitude,n.coords.longitude)}catch(n){console.error("Error obteniendo la ubicaci\xf3n:",n)}})()}guardarPos(o,n){var r=this;return(0,h.A)(function*(){r.userid=yield r.storage.get("user_id"),r.authService.savePos(r.userid,o,n).subscribe(a=>{"error"==a.status&&console.log("Erro",a.message)})})()}login(){this.authService.login(this.username,this.password).subscribe(o=>{"success"===o.status?(this.storage.set("user_id",o.data.user_id),this.storage.set("username",o.data.username),this.storage.set("cuenta_id",o.data.cuenta_id),this.storage.set("user_rioid",o.data.user_rioid),this.storage.set("user_nombre",o.data.user_nombre),this.storage.set("user_email",o.data.user_email),this.storage.set("est_id",o.data.est_id),this.storage.set("user_apellido",o.data.user_apellido),this.storage.set("token",o.data.token),this.menuS.habilitarMenu(!0),this.getPos(),this.navCtrl.navigateForward("/home")):console.log("Login fallido:",o.message)},o=>{console.error("Error en la petici\xf3n:",o)})}goToRegister(){console.log("Registro bot\xf3n/enlace clicado"),this.navCtrl.navigateForward("/register")}}return(e=g).\u0275fac=function(o){return new(o||e)(t.rXU(P.u),t.rXU(L.q9),t.rXU(M.w),t.rXU(p.$),t.rXU(C.L))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-login"]],decls:17,vars:2,consts:[["position","floating"],[3,"ngModelChange","ngModel"],["type","password",3,"ngModelChange","ngModel"],["expand","full",3,"click"],["expand","full","fill","outline",3,"click"]],template:function(o,n){1&o&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Iniciar Sesion"),t.k0s()()(),t.j41(4,"ion-content")(5,"ion-item")(6,"ion-label",0),t.EFF(7,"Username"),t.k0s(),t.j41(8,"ion-input",1),t.mxI("ngModelChange",function(a){return t.DH7(n.username,a)||(n.username=a),a}),t.k0s()(),t.j41(9,"ion-item")(10,"ion-label",0),t.EFF(11,"Password"),t.k0s(),t.j41(12,"ion-input",2),t.mxI("ngModelChange",function(a){return t.DH7(n.password,a)||(n.password=a),a}),t.k0s()(),t.j41(13,"ion-button",3),t.bIt("click",function(){return n.login()}),t.EFF(14,"Login"),t.k0s(),t.j41(15,"ion-button",4),t.bIt("click",function(){return n.goToRegister()}),t.EFF(16,"Registrarse"),t.k0s()()),2&o&&(t.R7$(8),t.R50("ngModel",n.username),t.R7$(4),t.R50("ngModel",n.password))},dependencies:[u.BC,u.vS,s.Jm,s.W9,s.eU,s.$w,s.uz,s.he,s.BC,s.ai,s.Gw]}),g})()}];let R=(()=>{var e;class g{}return(e=g).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[c.iI.forChild(F),c.iI]}),g})(),y=(()=>{var e;class g{}return(e=g).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[m.MD,u.YN,s.bv,u.X1,R,v.q1,f.eN]}),g})()}}]);